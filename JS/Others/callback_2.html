<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS CALLBACKS</title>
    <!-- Include Axios library -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

</head>
<body>
    <p>https://jsonplaceholder.typicode.com/ gives fake api like users, photos etc to work with <br>Axios is a popular JavaScript library used for making HTTP requests from a web browser or Node. js. It simplifies the process of sending asynchronous HTTP requests to a server, and also handles the response.</p>

    <label for="userDetails">Type User ID: </label>
    <input type="number" id="userDetails" min="1">

    <button onclick="getUser()">Get User</button>

    <div id="userOutput"></div>

    <label for="userActivity">Type User Activity: </label>
    <select id="userActivity">
        <option value="cooking">Cooking</option>
        <option value="adnet">ActivityDoesNotExist</option>
        <option value="relaxation">Relaxation</option>
        <option value="social">Social</option>
        <option value="diy">Diy</option>
        <option value="charity">Charity</option>
        <option value="recreational">Recreation</option>
        <option value="music">Music</option>
        <option value="busywork">Busy Work</option>
    </select>

    <button onclick="getActivity()">Get User</button>

    <div id="userOutputBox"></div>
    <p id="error"></p>


    <script>
       /*
       function greet(name, callback) {
            console.log('Hello, ' + name + '!');
            callback(); // invoking the callback function
        }

        function sayGoodbye() {
            console.log('Goodbye!');
        }

        greet('Alice', sayGoodbye); // passing sayGoodbye as a callback
/*

    sayGoodbye is a callback function passed to the greet function. 
    It gets executed after the greeting message.

    Understanding Asynchronous Callbacks:
    Callbacks are commonly used in asynchronous operations, 
    such as fetching data from a server or reading a file, 
    where the result is not immediately available.

*/
/*
    function fetchData(callback) {
        // Simulating asynchronous operation with setTimeout
        setTimeout(function() {
            const data = 'Some fetched data';
            callback(data); // invoking the callback function with data
        }, 5000); // simulate 5 seconds delay
    }

    function processData(data) {
        console.log('Processing data:', data);
    }

    fetchData(processData); // passing processData as a callback

   
    //------------

    function displayFruits() {
    console.log('Processing data');

    setTimeout(function() {
        const fruits = ['Apple', 'Banana', 'Cherry', 'Date', 'Elderberry'];
        console.log('Data:', fruits);
        }, 5000); // 5 seconds delay
    }

    displayFruits();
    //-----------------------//

    const button = document.getElementById('button');

    function callback(){
    console.log("Hello world");
    }

    button.addEventListener('click',callback);
-------------------------------------------------------


In JavaScript, the forEach loop is used to iterate over elements in an array and execute a callback function for each element. The callback function can take up to three parameters, which are commonly used for various purposes:

Element (required):
The first parameter represents the current element being processed in the array. It is required, and you can name it whatever you like. This parameter allows you to access the value of the current element during each iteration.
Index (optional):
The second parameter represents the index of the current element being processed in the array. It is optional, but if you omit it, you must still include a placeholder for it in the callback function's parameter list. This parameter allows you to access the index of the current element.
Array (optional):
The third parameter represents the array on which the forEach loop is being executed. It is optional, but if you omit it, you must still include a placeholder for it in the callback function's parameter list. This parameter allows you to access the array itself within the callback function.

const numbers = [1, 2, 3, 4, 5];

    numbers.forEach(function(element, index, array) {
        console.log('Element:', element);
        console.log('Index:', index);
        console.log('Array:', array);
    });

    Element: 1
    Index: 0
    Array: (5) [1, 2, 3, 4, 5]

    Element: 2
    Index: 1
    Array: (5) [1, 2, 3, 4, 5]

    This will happen 5x
*/

    //------------------------------//
    // Get a blog post and populate it

   /* const posts = [
        {title: 'Post One', body: 'Arise News Contents'},
        {title: 'Post Two', body: 'Channels News Contents'}
    ];
    

    function getPosts() {
        setTimeout(() => {
            let output = '';
            posts.forEach((post, index, array) => {
                output+= `<li>${post.title}</li> <p>${post.body}</p> <br>`;
            });
            document.body.innerHTML = output;
        }, 1000);
    };
    
    --------------
    function getPosts() {
        setTimeout(() => {
            let output = '';
            posts.forEach((post, index) => {
                output += `<li>Post ${index + 1}: ${post.title}</li> <p>${post.body}</p> <br>`;
            });

            document.body.innerHTML = output;
        }, 1000);
    };

    getPosts();


    ---------------
     function getPosts() {
        setTimeout(() => {
            let output = '';
            posts.forEach((post, index) => {
                const backgroundColor = index % 2 === 0 ? 'pink' : 'violet';
                output += `<li style="background-color: ${backgroundColor}">${post.title}</li> <p>${post.body}</p> <br>`;
            });
            document.body.innerHTML = output;
        }, 1000);
    };

    getPosts();

    -------------

        function getPosts() {
        setTimeout(() => {
            let output = '';
            posts.forEach((post, index) => {
                output += `<li><a href="#post-${index}">${post.title}</a></li> <p>${post.body}</p> <br>`;
            });

            document.body.innerHTML = output;
        }, 1000);
    };

    getPosts();

    -----------------
     const posts = [
        {title: 'Post One', body: 'Arise News Contents'},
        {title: 'Post Two', body: 'Channels News Contents'}
    ];
    

    function getPosts() {
        setTimeout(() => {
            let output = '';
            posts.forEach((post, index, array) => {
                output+= `<li>${post.title}</li> <p>${post.body}</p> <br>`;
            });
            document.body.innerHTML = output;
        }, 1000);
    };
    

   function createPost(post, callback) {
        setTimeout(() => {
            posts.push(post);
            callback();
        }, 2000);
   }
    
createPost({title: 'Post Three', body: 'News from AIT'}, getPosts);
    */

    const posts = [
        {title: 'Post One', body: 'Arise News Contents'},
        {title: 'Post Two', body: 'Channels News Contents'}
    ];
    
//Using promise now not normal cakllback way
    function getPosts() {
        setTimeout(() => {
            let output = '';
            posts.forEach((post, index, array) => {
                output+= `<li>${post.title}</li> <p>${post.body}</p> <br>`;
            });
            document.body.innerHTML = output;
        }, 1000);
    };
    
    function createPost(post){
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            posts.push(post);

            const hasErrorMessage = true;

            if(!hasErrorMessage){
                resolve();
            } else {
                reject('There was an error getting your posts.');
            }
        }, 2000);
    });
};

   /* createPost({title: 'New Post', body: 'BBC news podcasts'})
    .then(getPosts);
    
    or
   

    createPost({title: 'New Post', body: 'BBC news podcasts'})
    .then(getPosts)
    .catch(error => {
        console.error(error);
    });
or

     */

     /* How to use promise.all()

     promise1  = Promise.resolve('Hello boy');
     promise2 = 10;
     promise3 = new Promise((resolve, reject) => {
        setTimeout(resolve, 2000, 'Hello Goodbye');
     });
     promise4 = fetch('https://jsonplaceholder.typicode.com/users').then(response => response.json());


     Promise.all([promise1, promise2, promise3, promise4])
     .then(values => console.log(values));

     */


        function getUser() {
            const userId = document.getElementById('userDetails').value;

            // Check if userId is null or empty
            if (userId === null || userId === '') {
                document.getElementById('userOutput').innerHTML = 'User ID cannot be empty.';
            }
            // Check if userId is out of range
            else if (userId <= 0 || userId >= 11) {
                document.getElementById('userOutput').innerHTML = 'User ID is out of range.';
            }
            else {
                fetch(`https://jsonplaceholder.typicode.com/users/${userId}`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Failed to fetch user data');
                        }
                        return response.json();
                    })
                    .then(user => {
                        // Display user data
                        document.getElementById('userOutput').innerHTML = `
                            <h2><b>User Details</b></h2>
                            <p>User ID: ${user.id}</p>
                            <p>Name: ${user.name}</p>
                            <p>Email: ${user.email}</p>
                            <p>Username: ${user.username}</p>
                            <p>Phone: ${user.phone}</p>
                            <p>Website: ${user.website}</p>
                            <address>
                                <p>Address:</p>
                                <p>${user.address.street}, ${user.address.suite}</p>
                                <p>${user.address.city}, ${user.address.zipcode}</p>
                                <p>Geo: Lat ${user.address.geo.lat}, Lng ${user.address.geo.lng}</p>
                            </address>
                            <p>Company: ${user.company.name}</p>
                        `;
                    })
                    .catch(error => {
                        console.error(error);
                        const errorElement = document.getElementById('error');
                        errorElement.textContent = 'Failed to fetch activity data. Please try again later.';
                    });
            }
        };


        //Using AXIOS
        
        function getActivity() {
    const activityType = document.getElementById('userActivity').value;

    axios.get(`https://www.boredapi.com/api/activity?type=${activityType}`)
        .then(response => {
            const activity = response.data;
            if (activity.activity === undefined) {
                const errorBox = document.getElementById('error');
                errorBox.textContent = 'Invalid activity type. Please select a valid activity.';
            } else {
                const outputBox = document.getElementById('userOutputBox');
                outputBox.innerHTML = `
                    <h2><b>User Activity Details</b></h2>
                    <ul>
                        <li>Activity: ${activity.activity}</li>
                        <li>Type: ${activity.type}</li>
                        <li>Participants: ${activity.participants}</li>
                        <li>Price: ${activity.price}</li>
                        <li>Accessibility: ${activity.accessibility}</li>
                    </ul>
                `;
            }
        })
        .catch(error => {
            console.error(error);
            const errorBox = document.getElementById('error');
            errorBox.textContent = 'Failed to fetch activity data. Please try again later.';
        });
};


// ---------------//

function myDisplayer(something) {
  document.getElementById("demo").innerHTML = something;
}

function myCalculator(num1, num2, myCallback) {
  let sum = num1 + num2;
  myCallback(sum);
}

myCalculator(5, 5, myDisplayer);//After you have calculated sum, then display the answer

/*
So, a callback is a way to say, “Do this task, and when you’re done, let me know and do this next thing with the result.” It’s a method for handling tasks that might take some time, 
allowing other things to happen while waiting for the task to complete.

*/

/*
Installing
Using npm:

$ npm install axios



*/

//Using jsDelivr CDN:

//<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js">


//Using unpkg CDN:

//<script src="https://unpkg.com/axios/dist/axios.min.js">
    
    </script>
</body>
</html>